<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>รายละเอียดสินค้า</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <style>
        .product-img {
            max-width: 100%;
            margin-bottom: 10px;
        }

        .color-btn {
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .size-select {
            margin-top: 10px;
        }

        .thumb {
            width: 100px;
            cursor: pointer;
            margin-right: 5px;
        }
    </style>
</head>

<body>

    <div class="container" style="margin-top: 30px;">
        <div id="product-detail"></div>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const productName = urlParams.get('name');

        fetch('product.json')
            .then(response => response.json())
            .then(data => {
                const product = data.products.find(p => p.name === productName);
                const container = document.getElementById('product-detail');

                if (!product) {
                    container.innerHTML = '<div class="alert alert-danger">ไม่พบสินค้านี้</div>';
                    return;
                }

                let selectedColor = product.colors[0];
                let selectedImage = selectedColor.images[0];

                function render() {
                    container.innerHTML = `
          <div class="row">
            <div class="col-sm-6">
              <img id="mainImage" src="${selectedImage}" class="product-img img-responsive" alt="${product.name}">
              <div>
                ${selectedColor.images.map(img => `
                  <img src="${img}" class="thumb" onclick="document.getElementById('mainImage').src='${img}'">
                `).join('')}
              </div>
            </div>
            <div class="col-sm-6">
              <h2>${product.name}</h2>
              <p><strong>ราคา:</strong> $${product.price}</p>
              <p>${product.detail}</p>

              <div><strong>เลือกสี:</strong></div>
              ${product.colors.map((colorObj, i) => `
                <button class="btn btn-default color-btn" onclick="selectColor(${i})">${colorObj.color}</button>
              `).join('')}

              <div class="size-select">
                <label><strong>เลือกขนาด:</strong></label>
                <select class="form-control" style="width:150px;">
                  ${product.sizes.map(size => `<option>${size}</option>`).join('')}
                </select>
              </div>

              <button class="btn btn-success" style="margin-top: 15px;">เพิ่มลงตะกร้า</button>
            </div>
          </div>
        `;
                }

                // ฟังก์ชันเปลี่ยนสี
                window.selectColor = function (index) {
                    selectedColor = product.colors[index];
                    selectedImage = selectedColor.images[0];
                    render();
                };

                render(); // render ครั้งแรก
            });
    </script>

</body>

</html>